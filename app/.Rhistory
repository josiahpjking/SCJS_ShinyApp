#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
add_lines(
x=~year,y=~perc2,split=~variable,
color=~police_div,
text=~my_text2, hoverinfo="text",
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatte",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~change, colors=overview_cols) #%>%
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~change, colors=overview_cols) #%>%
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~police_div, colors=overview_cols) #%>%
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T) #%>%
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~police_div,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
#add_trace(inherit=F,
#         type="scatter",
#        mode="marker",
#       text=~my_text2, hoverinfo="text",
#      marker=list(symbol=24, size = 12),
#     x=~year,
#    y=~perc1,
#   color=~change,
#  showlegend=F) %>%
#add_lines(
# x=~year,y=~perc2,split=~variable,
#color=~police_div,
#text=~my_text2, hoverinfo="text",
#showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
#split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~variable,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~variable) %>%
add_trace(inherit=F,
type="bar",
x=~year,
y=~perc1,
color=~change,
colors=overview_cols,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~variable) %>%
add_trace(inherit=F,
type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,color=~variable,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F) %>%
add_annotations(text=~variable,x="2012/13",y=40)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
textposition="auto"
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
textposition="auto",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
plots <- do(d,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = 3, shareX = TRUE)
runApp()
runApp()
runApp()
runApp()
overview_data  %>% filter(variable %in% all_vars[[iov_var]]) %>%
filter(police_div %in% c("National Average",iov_pdiv)) %>%
mutate(
perc1=ifelse(police_div=="National Average",NA,percentage),
perc2=ifelse(police_div==iov_pdiv,NA,percentage)
) %>% group_by(variable) -> plotdat
plots <- do(plotdat,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = round(length(all_vars[[iov_var]])/2), shareX = TRUE)
subplot(plots[["p"]], nrows = round(length(all_vars[[iov_var]])/2), shareX = TRUE) %>%
layout(height=pheight) %>% config(modeBarButtonsToRemove = modebar_remove)
runApp()
overview_data  %>% filter(variable %in% all_vars[[iov_var]]) %>%
filter(police_div %in% c("National Average",iov_pdiv)) %>%
mutate(
perc1=ifelse(police_div=="National Average",percentage,NA),
perc2=ifelse(police_div==iov_pdiv,percentage,NA)
) %>% group_by(variable) -> plotdat
plots <- do(plotdat,
p = plot_ly(., x = ~year, y=~perc2,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc1,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = round(length(all_vars[[iov_var]])/2), shareX = TRUE) %>%
layout(height=pheight) %>% config(modeBarButtonsToRemove = modebar_remove)
overview_data  %>% filter(variable %in% all_vars[[iov_var]]) %>%
filter(police_div %in% c("National Average",iov_pdiv)) %>%
mutate(
perc1=ifelse(police_div=="National Average",percentage,NA),
perc2=ifelse(police_div==iov_pdiv,percentage,NA)
) %>% group_by(variable) -> plotdat
plots <- do(plotdat,
p = plot_ly(., x = ~year, y=~perc1,
split=~variable,
type="scatter",mode="lines",
text=~my_text2, hoverinfo="text",
showlegend=T,colors=overview_cols) %>%
add_trace(type="bar",
x=~year,
y=~perc2,
color=~change,
showlegend=F)
)
subplot(plots[["p"]], nrows = round(length(all_vars[[iov_var]])/2), shareX = TRUE) %>%
layout(height=pheight) %>% config(modeBarButtonsToRemove = modebar_remove)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
subplot(ppp[[1]])
subplot(ppp[1])
subplot(ppp)
runApp()
runApp()
shiny::runApp()
runApp()
